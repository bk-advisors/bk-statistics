---
title: <span style="color:white">Linear Regression Playbook</span>
subtitle: "A reference guide for future me and others who need it"

author: 
- name: "Matthew Kuch"
  email: kuch.matthew@gmail.com
date: 11/06/2025

title-block-banner: true
title-block-banner-color: "black"

format: html
html:
code-fold: false
code-summary: "Code"
echo: true
css: style.css
toc: true
toc-location: left
number-sections: false
editor: visual
fig-cap-location: margin
---

```{r message=FALSE, warning=FALSE}

# First we load the libraries and data
library(tidyverse)     # This lets you create plots with ggplot, manipulate data, etc.
library(broom)         # This lets you convert regression models into nice tables
library(modelsummary)  # This lets you combine multiple regression models into a single table

# Load the data. 
# It'd be a good idea to click on the "sat_gpa" object in the Environment panel
# in RStudio to see what the data looks like after you load it.
sat_gpa <- read_csv("input/sat_gpa.csv")



```

# Introduction

Using SAT and GPA data from Dartmouth College (["Chance" Course](https://chance.dartmouth.edu/course/Syllabi/Princeton96/Class12.html)) , the goal is to conduct some statistical analysis on this data to answer the questions listed in the sections below:

This is actually a form of People Analytics using Student Past Performance (e.g. SAT Grades) to Predict Future Performance.

Let's say you are a university admissions officer and you are curious if SAT scores really do predict college performance. You’re also interested in other factors that could influence student performance.

The data contains 6 variables:

-   `sex`: The sex of the student (male or female; female is the base case)

-   `sat_verbal`: The student’s *percentile* score in the verbal section of the SAT

-   `sat_math`: The student’s *percentile* score in the math section of the SAT

-   `sat_total`: `sat_verbal` + `sat_math`

-   `gpa_hs`: The student’s GPA in high school at graduation

-   `gpa_fy`: The student’s GPA at the end of their freshman year

### Correlations (Exploratory Questions)

#### **1. How well do SAT scores correlate with freshman GPA?**

##### 1.1 Using the Correlation Function

```{r}
cor(sat_gpa$sat_total,sat_gpa$gpa_fy)
```

##### 1.2 Drawing a scatterplot of the relationship using ggplot

```{r}
ggplot(data = sat_gpa, mapping = aes(x=sat_total, y=gpa_fy)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  labs(x="Total SAT Score", y="Freshman GPA")
```

...

#### **2. How well does high school GPA correlate with freshman GPA?**

##### 2.1 Using the Correlation Function

```{r}
cor(sat_gpa$gpa_hs,sat_gpa$gpa_fy)
```

##### 2.2 Drawing a scatterplot of the relationship using ggplot

```{r}
ggplot(data = sat_gpa, mapping = aes(x=gpa_hs, y=gpa_fy)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x="Highschool GPA", y="Freshman GPA")
```

...

#### **3A. Is the correlation between SAT scores and freshman GPA stronger for men or for women?**

```{r}
sat_gpa |> 
  group_by(sex) |> 
  summarise(correlation = cor(sat_total,gpa_fy))
```

#### **3B. Is the correlation between HighSchool GPA and freshman GPA stronger for men or for women?**

```{r}
sat_gpa |> 
  group_by(sex) |> 
  summarise(correlation = cor(gpa_hs,gpa_fy))
```

```{r}
ggplot(data = sat_gpa, mapping = aes(x=gpa_hs, y=gpa_fy, color=sex)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x="Highschool GPA", y="Freshman GPA")
```

....

### Predictive Models

#### **4. Do SAT scores predict freshman GPAs?**

A reminder of the formula we'll be replicating when doing linear regression i.e. Y = mX + b, where:

-   Y - the outcome variable

-   X - in the explanatory variable

-   m - is the slope (rise over run)

-   b - is the Y-intercept

For this particular case, it can be represented by the formula below:

![](assets/linear-regression-equation.png){fig-align="center"}

-   Where the "E" looking symbol at the end represents the standard error

The R-code to implement this, is below:

```{r}
model_sat_gpa <- lm(gpa_fy ~ sat_total, data = sat_gpa) # You can read this as Freshman gpa "is explained by" / "~" SAT scores

# Look at the model results and include confidence intervals for the coefficients
tidy(model_sat_gpa, conf.int = TRUE)
```

Here’s what these coefficients mean:

-   The Y-intercept (Beta-0) is 0.002, which means that the average freshman GPA will be 0.002 when the total SAT percentile score is 0. This is a pretty nonsensical number (nobody has a score that low), so we can ignore it.

-   The slope of `sat_total` (Beta-1) is 0.024, which means that a 1 percentile increase in SAT score is associated with a 0.024 point increase in GPA, on average. Rise over Run i.e. 1% rise, 0.024 run.

We can look at the summary table of the regression to check the R-squared (R\^2) :

```{r}
glance(model_sat_gpa)
```

The R-squared here is 0.212, which means that SAT scores explain 21% of the variation in freshman GPA. It’s not a fantastic model, but it explains some stuff.

...

#### **5. Does a certain type of SAT score have a larger effect on freshman GPAs?**

The 2 types of SAT scores are:

-   SAT Verbal, and

-   SAT Math

This particular case, can be represented by the formula below:

![](assets/multi-variate-linear-regression.png)

Implementing this in R:

```{r}
model_sat_gpa_types <- lm(gpa_fy ~ sat_verbal + sat_math, data = sat_gpa)

tidy(model_sat_gpa_types, conf.int = TRUE)
```

-   Again, the intercept is meaningless since no student has a zero on both the verbal and the math test.

-   The slope for `sat_verbal` (or Beta-1) is 0.025, so a one percentile point increase in the verbal SAT is associated with a 0.025 point increase in GPA, on average, controlling for math scores

-   Meanwhile, a one percentile point increase in the math SAT () is associated with a 0.022 point increase in GPA, on average, controlling for verbal scores.

These are essentially the same, so at first glance, it doesn’t seem like the type of test has substantial bearing on college GPAs.

**Checking the Adjusted R-squared:**

```{r}
glance(model_sat_gpa_types)
```

The adjusted R-squared (which we need to look at because we’re using more than one explanatory variable) is 0.211, which means that this model explains 21% of the variation in college GPA. Like before, this isn’t great, but it tells us a little bit about the importance of SAT scores.

...

#### **6. Do high school GPAs predict freshman GPAs?**

...

#### **7. Which model best predicts freshman GPA? How do you know?**

...

# Notes and References:

-   <https://evalf20.classes.andrewheiss.com/example/regression/>

-   <https://youtu.be/E-Zz5S5NOUo>

-   <https://chance.dartmouth.edu/course/Syllabi/Princeton96/Class12.html>

-   <https://chance.dartmouth.edu/course/Syllabi/Princeton96/princeton96.html>

-   <https://chance.dartmouth.edu/>
